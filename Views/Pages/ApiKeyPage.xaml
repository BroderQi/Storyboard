<UserControl x:Class="Storyboard.Views.Pages.ApiKeyPage"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d"
             d:DesignHeight="450" d:DesignWidth="800">

    <ScrollViewer Padding="40" Background="#0F0F0F">
        <StackPanel MaxWidth="860">
            <TextBlock Text="üîë AI ÊúçÂä°ÈÖçÁΩÆ" FontSize="28" FontWeight="Bold" Foreground="#E0E0E0" Margin="0,0,0,18"/>
            <TextBlock TextWrapping="Wrap" Foreground="#A0A0A0" FontSize="12" Margin="0,0,0,24">
                ÈÖçÁΩÆÂ∞ÜÂÜôÂÖ•Â∫îÁî®ÁõÆÂΩï‰∏ãÁöÑ appsettings.jsonÔºåÂπ∂Á´ãÂç≥Âà∑Êñ∞ÔºàÊó†ÈúÄÈáçÂêØÂç≥ÂèØ‚ÄúÈ™åËØÅÈÖçÁΩÆ‚ÄùÔºâ„ÄÇ
            </TextBlock>

            <!-- Default Provider -->
            <Border Background="#1E1E1E" BorderBrush="#3E3E42" BorderThickness="1" Padding="20" Margin="0,0,0,20">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <TextBlock Grid.Column="0" Text="ÈªòËÆ§ Provider" Foreground="#E0E0E0" FontWeight="SemiBold" VerticalAlignment="Center" Margin="0,0,16,0"/>
                    <ComboBox Grid.Column="1" ItemsSource="{Binding AvailableProviderTypes}" SelectedItem="{Binding DefaultProvider}" Height="34"/>
                </Grid>
            </Border>

            <TabControl>
                <!-- Qwen -->
                <TabItem Header="ÈÄö‰πâÂçÉÈóÆ (Qwen)">
                    <StackPanel Margin="16">
                        <CheckBox Content="ÂêØÁî®" IsChecked="{Binding QwenEnabled}" Foreground="#E0E0E0" Margin="0,0,0,12"/>

                        <TextBlock Text="API Key" Foreground="#E0E0E0"/>
                        <TextBox Text="{Binding QwenApiKey}" Height="34" Background="#2D2D30" Foreground="#E0E0E0" BorderBrush="#3E3E42" Padding="10,6"/>

                        <TextBlock Text="ÈªòËÆ§Ê®°Âûã" Foreground="#E0E0E0" Margin="0,12,0,0"/>
                        <TextBox Text="{Binding QwenDefaultModel}" Height="34" Background="#2D2D30" Foreground="#E0E0E0" BorderBrush="#3E3E42" Padding="10,6"/>

                        <TextBlock Text="Endpoint" Foreground="#E0E0E0" Margin="0,12,0,0"/>
                        <TextBox Text="{Binding QwenEndpoint}" Height="34" Background="#2D2D30" Foreground="#E0E0E0" BorderBrush="#3E3E42" Padding="10,6"/>

                        <TextBlock Text="Ë∂ÖÊó∂ÔºàÁßíÔºâ" Foreground="#E0E0E0" Margin="0,12,0,0"/>
                        <TextBox Text="{Binding QwenTimeoutSeconds}" Height="34" Background="#2D2D30" Foreground="#E0E0E0" BorderBrush="#3E3E42" Padding="10,6"/>
                    </StackPanel>
                </TabItem>

                <!-- Wenxin -->
                <TabItem Header="ÊñáÂøÉ‰∏ÄË®Ä (Wenxin)">
                    <StackPanel Margin="16">
                        <CheckBox Content="ÂêØÁî®" IsChecked="{Binding WenxinEnabled}" Foreground="#E0E0E0" Margin="0,0,0,12"/>

                        <TextBlock Text="API Key" Foreground="#E0E0E0"/>
                        <TextBox Text="{Binding WenxinApiKey}" Height="34" Background="#2D2D30" Foreground="#E0E0E0" BorderBrush="#3E3E42" Padding="10,6"/>

                        <TextBlock Text="API Secret" Foreground="#E0E0E0" Margin="0,12,0,0"/>
                        <TextBox Text="{Binding WenxinApiSecret}" Height="34" Background="#2D2D30" Foreground="#E0E0E0" BorderBrush="#3E3E42" Padding="10,6"/>

                        <TextBlock Text="ÈªòËÆ§Ê®°Âûã" Foreground="#E0E0E0" Margin="0,12,0,0"/>
                        <TextBox Text="{Binding WenxinDefaultModel}" Height="34" Background="#2D2D30" Foreground="#E0E0E0" BorderBrush="#3E3E42" Padding="10,6"/>

                        <TextBlock Text="Endpoint" Foreground="#E0E0E0" Margin="0,12,0,0"/>
                        <TextBox Text="{Binding WenxinEndpoint}" Height="34" Background="#2D2D30" Foreground="#E0E0E0" BorderBrush="#3E3E42" Padding="10,6"/>

                        <TextBlock Text="Ë∂ÖÊó∂ÔºàÁßíÔºâ" Foreground="#E0E0E0" Margin="0,12,0,0"/>
                        <TextBox Text="{Binding WenxinTimeoutSeconds}" Height="34" Background="#2D2D30" Foreground="#E0E0E0" BorderBrush="#3E3E42" Padding="10,6"/>
                    </StackPanel>
                </TabItem>

                <!-- Zhipu -->
                <TabItem Header="Êô∫Ë∞± (Zhipu)">
                    <StackPanel Margin="16">
                        <CheckBox Content="ÂêØÁî®" IsChecked="{Binding ZhipuEnabled}" Foreground="#E0E0E0" Margin="0,0,0,12"/>

                        <TextBlock Text="API Key" Foreground="#E0E0E0"/>
                        <TextBox Text="{Binding ZhipuApiKey}" Height="34" Background="#2D2D30" Foreground="#E0E0E0" BorderBrush="#3E3E42" Padding="10,6"/>

                        <TextBlock Text="ÈªòËÆ§Ê®°Âûã" Foreground="#E0E0E0" Margin="0,12,0,0"/>
                        <TextBox Text="{Binding ZhipuDefaultModel}" Height="34" Background="#2D2D30" Foreground="#E0E0E0" BorderBrush="#3E3E42" Padding="10,6"/>

                        <TextBlock Text="Endpoint" Foreground="#E0E0E0" Margin="0,12,0,0"/>
                        <TextBox Text="{Binding ZhipuEndpoint}" Height="34" Background="#2D2D30" Foreground="#E0E0E0" BorderBrush="#3E3E42" Padding="10,6"/>

                        <TextBlock Text="Ë∂ÖÊó∂ÔºàÁßíÔºâ" Foreground="#E0E0E0" Margin="0,12,0,0"/>
                        <TextBox Text="{Binding ZhipuTimeoutSeconds}" Height="34" Background="#2D2D30" Foreground="#E0E0E0" BorderBrush="#3E3E42" Padding="10,6"/>
                    </StackPanel>
                </TabItem>

                <!-- Volcengine -->
                <TabItem Header="ÁÅ´Â±±ÂºïÊìé (Volcengine)">
                    <StackPanel Margin="16">
                        <CheckBox Content="ÂêØÁî®" IsChecked="{Binding VolcengineEnabled}" Foreground="#E0E0E0" Margin="0,0,0,12"/>

                        <TextBlock Text="API Key" Foreground="#E0E0E0"/>
                        <TextBox Text="{Binding VolcengineApiKey}" Height="34" Background="#2D2D30" Foreground="#E0E0E0" BorderBrush="#3E3E42" Padding="10,6"/>

                        <TextBlock Text="EndpointId" Foreground="#E0E0E0" Margin="0,12,0,0"/>
                        <TextBox Text="{Binding VolcengineEndpointId}" Height="34" Background="#2D2D30" Foreground="#E0E0E0" BorderBrush="#3E3E42" Padding="10,6"/>

                        <TextBlock Text="ÈªòËÆ§Ê®°Âûã" Foreground="#E0E0E0" Margin="0,12,0,0"/>
                        <TextBox Text="{Binding VolcengineDefaultModel}" Height="34" Background="#2D2D30" Foreground="#E0E0E0" BorderBrush="#3E3E42" Padding="10,6"/>

                        <TextBlock Text="Endpoint" Foreground="#E0E0E0" Margin="0,12,0,0"/>
                        <TextBox Text="{Binding VolcengineEndpoint}" Height="34" Background="#2D2D30" Foreground="#E0E0E0" BorderBrush="#3E3E42" Padding="10,6"/>

                        <TextBlock Text="Ë∂ÖÊó∂ÔºàÁßíÔºâ" Foreground="#E0E0E0" Margin="0,12,0,0"/>
                        <TextBox Text="{Binding VolcengineTimeoutSeconds}" Height="34" Background="#2D2D30" Foreground="#E0E0E0" BorderBrush="#3E3E42" Padding="10,6"/>
                    </StackPanel>
                </TabItem>
            </TabControl>

            <!-- Validation results (in-page) -->
            <Border Background="#1E1E1E" BorderBrush="#3E3E42" BorderThickness="1" Padding="20" Margin="0,20,0,0">
                <StackPanel>
                    <TextBlock Text="È™åËØÅÁªìÊûú" FontSize="14" FontWeight="SemiBold" Foreground="#E0E0E0" Margin="0,0,0,12"/>

                    <DataGrid ItemsSource="{Binding ValidationResults}" AutoGenerateColumns="False" CanUserAddRows="False"
                              HeadersVisibility="Column" GridLinesVisibility="Horizontal" RowHeight="34"
                              Background="#1E1E1E" Foreground="#E0E0E0" BorderThickness="0">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Êó∂Èó¥" Binding="{Binding Timestamp, StringFormat=HH:mm:ss}" Width="120" IsReadOnly="True"/>
                            <DataGridTextColumn Header="Provider" Binding="{Binding Provider}" Width="180" IsReadOnly="True"/>
                            <DataGridTextColumn Header="ÁªìÊûú" Binding="{Binding ResultText}" Width="100" IsReadOnly="True"/>
                            <DataGridTextColumn Header="ËØ¶ÊÉÖ" Binding="{Binding Message}" Width="*" IsReadOnly="True"/>
                        </DataGrid.Columns>
                    </DataGrid>

                    <TextBlock Text="{Binding StatusMessage}" Foreground="#A0A0A0" FontSize="12" Margin="0,12,0,0" TextWrapping="Wrap"/>
                </StackPanel>
            </Border>

            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,20,0,0">
                <Button Content="‚Üª ÈáçÊñ∞Âä†ËΩΩ" Command="{Binding ReloadCommand}" Margin="0,0,12,0" Padding="16,10"/>
                <Button Content="‚úÖ È™åËØÅÈÖçÁΩÆ" Command="{Binding ValidateCommand}" Margin="0,0,12,0" Padding="16,10"/>
                <Button Content="üíæ ‰øùÂ≠òÈÖçÁΩÆ" Command="{Binding SaveCommand}" Style="{StaticResource PrimaryButton}" Padding="24,12" FontSize="14"/>
            </StackPanel>
        </StackPanel>
    </ScrollViewer>
</UserControl>
